<!-- courses.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Browse Notes ‚Äì StudyNotes</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body {
      background: #020617;
      color: #ffffff;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      line-height: 1.6;
      overflow-x: hidden;
      opacity: 0;
      transition: opacity 0.4s ease-out;
    }
    body.loaded { opacity: 1; }
    body.fade-out { opacity: 0; }

    nav {
      position: fixed;
      top: 0; left: 0; right: 0;
      z-index: 1000;
      background: rgba(2, 6, 23, 0.96);
      backdrop-filter: blur(16px);
      border-bottom: 1px solid rgba(148, 163, 184, 0.35);
      padding: 16px 5vw;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-size: 1.1rem;
      font-weight: 700;
      letter-spacing: 2px;
      text-transform: uppercase;
      color: #e5e7eb;
      cursor: pointer;
      text-decoration: none;
    }

    .back-btn {
      border: 1px solid rgba(148, 163, 184, 0.8);
      padding: 7px 14px;
      border-radius: 999px;
      text-decoration: none;
      color: rgba(229, 231, 235, 0.9);
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      transition: all 0.25s ease;
      cursor: pointer;
      background: rgba(15, 23, 42, 0.9);
    }

    .back-btn:hover {
      color: #f9fafb;
      border-color: #f9fafb;
      background: rgba(15, 23, 42, 1);
    }

    main {
      padding-top: 96px;
      padding-bottom: 48px;
      min-height: 100vh;
      display: flex;
      justify-content: center;
    }

    .step-container {
      width: 100%;
      max-width: 1040px;
      padding: 0 5vw;
      position: relative;
    }

    /* Step transitions */
    .step {
      opacity: 0;
      transform: translateY(24px);
      pointer-events: none;
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      transition:
        opacity 0.35s ease-out,
        transform 0.35s ease-out;
    }

    .step.active {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
      position: relative;
    }

    .step-header-block {
      margin-bottom: 16px;
    }

    .results {
      margin-top: 8px;
      flex: 1 1 auto;
      min-height: 0;
      max-height: 430px;
      overflow-y: auto;
      padding-right: 6px;
      scroll-behavior: smooth;
    }

    .results::-webkit-scrollbar { width: 6px; }
    .results::-webkit-scrollbar-thumb {
      background: rgba(51, 65, 85, 1);
      border-radius: 999px;
    }

    .bottom-actions {
      margin-top: 18px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 14px;
      flex-wrap: wrap;
    }

    .step-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
    }

    .dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: rgba(51, 65, 85, 1);
      transition: all 0.25s ease;
    }

    .dot.active {
      background: #38bdf8;
      transform: scale(1.4);
      box-shadow: 0 0 14px rgba(56, 189, 248, 0.9);
    }

    .step-label {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      color: rgba(148, 163, 184, 0.9);
    }

    .step-title {
      font-size: 2.1rem;
      font-weight: 800;
      letter-spacing: -0.04em;
      margin-bottom: 6px;
    }

    .step-subtitle {
      color: rgba(226, 232, 240, 0.9);
      margin-bottom: 26px;
      max-width: 520px;
      font-size: 0.95rem;
    }

    .class-buttons,
    .subject-grid {
      display: flex;
      gap: 14px;
      flex-wrap: wrap;
      margin-top: 8px;
    }

    .pill-btn {
      padding: 11px 18px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: rgba(15, 23, 42, 0.95);
      color: rgba(226, 232, 240, 0.96);
      font-size: 0.82rem;
      font-weight: 600;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      transition: all 0.25s ease;
    }

    .pill-btn:hover {
      border-color: #e5e7eb;
      background: #020617;
      transform: translateY(-1px);
    }

    .pill-btn.selected {
      border-color: #38bdf8;
      background: rgba(8, 47, 73, 0.95);
      color: #e0f2fe;
      box-shadow: 0 0 0 2px rgba(56, 189, 248, 0.35);
    }

    .subject-card {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 14px;
      border-radius: 16px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(51, 65, 85, 1);
      cursor: pointer;
      transition: all 0.22s ease;
      min-width: 180px;
    }

    .subject-card-icon {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
    }

    .subject-card-name {
      font-weight: 600;
      font-size: 0.88rem;
    }

    .subject-card.selected {
      border-color: #38bdf8;
      box-shadow: 0 0 0 2px rgba(56, 189, 248, 0.35);
      background: rgba(15, 23, 42, 1);
    }

    .text-link {
      font-size: 0.82rem;
      color: rgba(148, 163, 184, 0.9);
      cursor: pointer;
      text-decoration: underline;
      text-decoration-style: dotted;
      text-underline-offset: 3px;
    }

    .primary-btn {
      padding: 10px 20px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #0ea5e9, #38bdf8);
      color: #f9fafb;
      font-weight: 600;
      font-size: 0.86rem;
      text-transform: uppercase;
      letter-spacing: 1.4px;
      cursor: pointer;
      transition: all 0.25s ease;
    }

    .primary-btn:hover:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 0 16px 40px rgba(56, 189, 248, 0.55);
    }

    .primary-btn:disabled {
      opacity: 0.35;
      cursor: default;
      box-shadow: none;
      transform: none;
    }

    .search-row {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-top: 4px;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }

    .search-wrapper {
      position: relative;
      flex: 1;
      min-width: 260px;
    }

    .search-input {
      width: 100%;
      padding: 12px 16px 12px 44px;
      border-radius: 999px;
      border: 1px solid rgba(51, 65, 85, 1);
      background: rgba(15, 23, 42, 0.98);
      color: #e5e7eb;
      font-size: 0.9rem;
    }

    .search-input::placeholder {
      color: rgba(148, 163, 184, 0.9);
    }

    .search-input:focus {
      outline: none;
      border-color: #38bdf8;
      box-shadow: 0 0 0 2px rgba(56, 189, 248, 0.35);
    }

    .search-icon {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.9rem;
      color: rgba(148, 163, 184, 0.95);
    }

    .filter-badge {
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(51, 65, 85, 1);
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      color: rgba(209, 213, 219, 0.92);
      white-space: nowrap;
    }

    .topic-card {
      background: linear-gradient(135deg, rgba(15,23,42,0.98), rgba(15,23,42,1));
      border-radius: 18px;
      padding: 14px 18px 13px;
      margin-bottom: 10px;
      border-left: 4px solid;
      transition: all 0.22s ease;
      cursor: pointer;
    }

    .topic-card:hover {
      transform: translateX(6px);
      box-shadow: 0 18px 50px rgba(15, 23, 42, 0.85);
    }

    .topic-title-row {
      display: flex;
      justify-content: space-between;
      gap: 12px;
      align-items: flex-start;
      margin-bottom: 4px;
    }

    .topic-name {
      font-weight: 700;
      font-size: 0.98rem;
    }

    .topic-meta {
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 1.1px;
      color: rgba(148, 163, 184, 0.96);
    }

    .topic-desc {
      font-size: 0.88rem;
      color: rgba(229, 231, 235, 0.9);
    }

    .empty-state {
      padding: 40px 10px;
      text-align: center;
      color: rgba(148, 163, 184, 0.9);
      font-size: 0.9rem;
    }

    /* Preview modal */
    #previewOverlay {
      position: fixed;
      inset: 0;
      z-index: 1100;
      display: none;
      align-items: center;
      justify-content: center;
    }

    #previewBackdrop {
      position: absolute;
      inset: 0;
      background: rgba(15, 23, 42, 0.75);
      backdrop-filter: blur(6px);
    }

    #previewModal {
      position: relative;
      z-index: 1;
      width: min(960px, 100% - 32px);
      max-height: 90vh;
      background: #020617;
      border-radius: 18px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      box-shadow: 0 28px 80px rgba(15, 23, 42, 0.95);
      padding: 16px 18px 14px;
      display: flex;
      flex-direction: column;
    }

    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-bottom: 8px;
    }

    .preview-title {
      font-weight: 700;
      font-size: 1rem;
    }

    .preview-subtitle {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: rgba(148, 163, 184, 0.95);
    }

    .preview-close {
      border: none;
      background: transparent;
      color: rgba(148, 163, 184, 0.95);
      cursor: pointer;
      font-size: 1.1rem;
    }

    .preview-body {
      flex: 1 1 auto;
      min-height: 0;
      margin-top: 6px;
      margin-bottom: 10px;
    }

    .preview-frame {
      width: 100%;
      height: 60vh;
      border: none;
      border-radius: 10px;
      background: #020617;
    }

    .preview-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    .preview-note {
      font-size: 0.8rem;
      color: rgba(148, 163, 184, 0.95);
    }

    @media (max-width: 768px) {
      .step-container { padding: 0 20px; }
      .step-title { font-size: 1.7rem; }
      .step-subtitle { font-size: 0.9rem; }
      .subject-card { flex: 1 1 calc(50% - 10px); min-width: 0; }
      .bottom-actions { flex-direction: column-reverse; align-items: flex-start; }
      .filter-badge { width: 100%; text-align: center; }
      .preview-frame { height: 55vh; }
    }
  </style>
</head>
<body>
  <nav>
    <div class="logo" onclick="navigate('index.html')">StudyNotes</div>
    <button class="back-btn" type="button" onclick="goBackStep()">‚Üê Back</button>
  </nav>

  <main>
    <div class="step-container">
      <!-- STEP 1 -->
      <div class="step active" id="step1">
        <div class="step-header-block">
          <div class="step-indicator">
            <div class="dot active"></div>
            <div class="dot"></div>
            <span class="step-label">Step 1 ¬∑ Choose class</span>
          </div>
          <h2 class="step-title">Which class are you looking for?</h2>
          <p class="step-subtitle">
            Select whether you want Class 11 or Class 12 JEE notes. You can come back and switch at any time.
          </p>

          <div class="class-buttons">
            <button class="pill-btn" data-class="11" onclick="selectClass(this)">Class 11</button>
            <button class="pill-btn" data-class="12" onclick="selectClass(this)">Class 12</button>
          </div>
        </div>

        <div class="results"></div>

        <div class="bottom-actions">
          <span class="text-link" onclick="navigate('index.html')">Back to main page</span>
          <button class="primary-btn" id="toStep2Btn" type="button" disabled onclick="goToStep(2)">Continue</button>
        </div>
      </div>

      <!-- STEP 2 -->
      <div class="step" id="step2">
        <div class="step-header-block">
          <div class="step-indicator">
            <div class="dot active"></div>
            <div class="dot active"></div>
            <span class="step-label">Step 2 ¬∑ Choose subjects</span>
          </div>
          <h2 class="step-title">Which subjects do you want?</h2>
          <p class="step-subtitle">
            Pick one or more subjects for Class <span id="classLabel"></span>. Topics will be filtered to match this selection.
          </p>

          <div class="subject-grid">
            <div class="subject-card" data-subject="physics" onclick="toggleSubject(this)">
              <div class="subject-card-icon" style="background: rgba(56,189,248,0.16); color:#38bdf8;">P</div>
              <div class="subject-card-name">Physics</div>
            </div>
            <div class="subject-card" data-subject="chemistry" onclick="toggleSubject(this)">
              <div class="subject-card-icon" style="background: rgba(45,212,191,0.16); color:#14b8a6;">C</div>
              <div class="subject-card-name">Chemistry</div>
            </div>
            <div class="subject-card" data-subject="maths" onclick="toggleSubject(this)">
              <div class="subject-card-icon" style="background: rgba(248,113,113,0.16); color:#f97373;">M</div>
              <div class="subject-card-name">Mathematics</div>
            </div>
            <div class="subject-card" data-subject="biology" onclick="toggleSubject(this)">
              <div class="subject-card-icon" style="background: rgba(74,222,128,0.16); color:#22c55e;">B</div>
              <div class="subject-card-name">Biology</div>
            </div>
          </div>
        </div>

        <div class="results"></div>

        <div class="bottom-actions">
          <span class="text-link" onclick="goToStep(1)">‚Üê Back to class selection</span>
          <button class="primary-btn" id="toStep3Btn" type="button" disabled onclick="goToStep(3)">Show topics</button>
        </div>
      </div>

      <!-- STEP 3 -->
      <div class="step" id="step3">
        <div class="step-header-block">
          <div class="step-indicator">
            <div class="dot active"></div>
            <div class="dot active"></div>
            <span class="step-label">Step 3 ¬∑ Search topics</span>
          </div>
          <h2 class="step-title">Browse chapter-wise notes</h2>
          <p class="step-subtitle">
            Filter topics for Class <span id="classLabel2"></span> using the search bar. Each description is short and ends with an ellipsis.
          </p>

          <div class="search-row">
            <div class="search-wrapper">
              <span class="search-icon">üîç</span>
              <input id="searchInput" type="text" class="search-input" placeholder="Search topics by name or concept..." />
            </div>
            <div id="activeFilters" class="filter-badge"></div>
          </div>
        </div>

        <div class="results" id="results"></div>

        <div class="bottom-actions">
          <span class="text-link" onclick="goToStep(2)">‚Üê Back to subjects</span>
          <span class="text-link" onclick="restartAll()">Choose a different set of notes</span>
        </div>
      </div>
    </div>
  </main>

  <!-- Preview modal -->
  <div id="previewOverlay">
    <div id="previewBackdrop"></div>
    <div id="previewModal">
      <div class="preview-header">
        <div>
          <div id="previewTitle" class="preview-title"></div>
          <div id="previewSubtitle" class="preview-subtitle"></div>
        </div>
        <button type="button" class="preview-close" onclick="closePreview()">‚úï</button>
      </div>
      <div class="preview-body">
        <iframe id="previewFrame" class="preview-frame" src="" title="Notes preview"></iframe>
      </div>
      <div class="preview-footer">
        <span class="preview-note">You are seeing only the first 4 pages of this chapter.</span>
        <button type="button" class="primary-btn" id="previewFullBtn">Get full notes</button>
      </div>
    </div>
  </div>

  <script>
    // Add previewUrl/fullUrl per topic
    const topicsByClass = {
      "11": {
        physics: [
          { name: "Kinematics",
            desc: "Displacement, velocity, acceleration, graphs and projectile motion patterns used in typical one- and two-dimensional JEE questions...",
            previewUrl: "pdfs/11/physics/kinematics-preview.pdf",
            fullUrl: "pdfs/11/physics/kinematics-full.pdf"
          },
          { name: "Laws of Motion",
            desc: "Newton‚Äôs laws, free-body diagrams, friction models and standard multiple-block, pulley or circular motion setups seen in exams...",
            previewUrl: "pdfs/11/physics/laws-of-motion-preview.pdf",
            fullUrl: "pdfs/11/physics/laws-of-motion-full.pdf"
          },
          { name: "Work, Energy and Power",
            desc: "Work‚Äìenergy theorem, conservative forces, power calculation and chained problems mixing springs, gravity and variable forces...",
            previewUrl: "pdfs/11/physics/wep-preview.pdf",
            fullUrl: "pdfs/11/physics/wep-full.pdf"
          },
          { name: "Rotational Motion",
            desc: "Torque, angular momentum, moment of inertia, rolling motion and composite body problems that combine translation with rotation...",
            previewUrl: "pdfs/11/physics/rotational-preview.pdf",
            fullUrl: "pdfs/11/physics/rotational-full.pdf"
          },
          { name: "Gravitation",
            desc: "Inverse-square law, field and potential, orbital velocity, satellite energy changes and common JEE-style planetary motion questions...",
            previewUrl: "pdfs/11/physics/gravitation-preview.pdf",
            fullUrl: "pdfs/11/physics/gravitation-full.pdf"
          },
          { name: "Thermodynamics",
            desc: "Heat, internal energy, laws of thermodynamics, PV curves and engine efficiency questions focusing on basic but high-yield models...",
            previewUrl: "pdfs/11/physics/thermo-preview.pdf",
            fullUrl: "pdfs/11/physics/thermo-full.pdf"
          }
        ],
        chemistry: [
          { name: "Some Basic Concepts of Chemistry",
            desc: "Mole concept, empirical and molecular formulae, limiting reagent and percentage composition calculations that form the base of many numericals...",
            previewUrl: "pdfs/11/chem/basic-concepts-preview.pdf",
            fullUrl: "pdfs/11/chem/basic-concepts-full.pdf"
          },
          { name: "Atomic Structure",
            desc: "Photoelectric ideas, quantum numbers, Bohr model, subshell filling and configuration tricks used to predict valence patterns quickly...",
            previewUrl: "pdfs/11/chem/atomic-structure-preview.pdf",
            fullUrl: "pdfs/11/chem/atomic-structure-full.pdf"
          },
          { name: "Chemical Bonding",
            desc: "Lewis structures, VSEPR shapes, hybridisation, bond parameters and quick geometry rules frequently tested in conceptual reasoning questions...",
            previewUrl: "pdfs/11/chem/chemical-bonding-preview.pdf",
            fullUrl: "pdfs/11/chem/chemical-bonding-full.pdf"
          },
          { name: "States of Matter",
            desc: "Gas laws, kinetic theory, ideal and real gas behavior, van der Waals corrections and typical graph-based questions with pressure or volume...",
            previewUrl: "pdfs/11/chem/states-of-matter-preview.pdf",
            fullUrl: "pdfs/11/chem/states-of-matter-full.pdf"
          },
          { name: "Equilibrium",
            desc: "Le Chatelier applications, equilibrium constants, pH, buffer overview and common JEEmain numericals mixing solubility and ionic equilibria...",
            previewUrl: "pdfs/11/chem/equilibrium-preview.pdf",
            fullUrl: "pdfs/11/chem/equilibrium-full.pdf"
          }
        ],
        maths: [
          { name: "Sets, Relations and Functions",
            desc: "Set operations, Venn diagrams, relation types and function basics underpinning questions on domain, range and composition of mappings...",
            previewUrl: "pdfs/11/maths/sets-relations-preview.pdf",
            fullUrl: "pdfs/11/maths/sets-relations-full.pdf"
          },
          { name: "Complex Numbers",
            desc: "Argand plane, polar form, conjugate geometry, triangle inequalities and locus-style questions connecting algebra with simple diagrams...",
            previewUrl: "pdfs/11/maths/complex-preview.pdf",
            fullUrl: "pdfs/11/maths/complex-full.pdf"
          },
          { name: "Quadratic Equations",
            desc: "Nature of roots, discriminant analysis, parameter-based root conditions and standard transformations used to simplify algebraic expressions...",
            previewUrl: "pdfs/11/maths/quadratic-preview.pdf",
            fullUrl: "pdfs/11/maths/quadratic-full.pdf"
          },
          { name: "Sequences and Series",
            desc: "AP, GP, HP, telescoping sums and small manipulation tricks used to collapse complicated expressions into neat, exam-friendly forms...",
            previewUrl: "pdfs/11/maths/sequences-preview.pdf",
            fullUrl: "pdfs/11/maths/sequences-full.pdf"
          },
          { name: "Limits and Continuity",
            desc: "Standard limits, factorisation, L‚ÄôH√¥pital basics and continuity checks that appear in first-principles differentiation or graph questions...",
            previewUrl: "pdfs/11/maths/limits-preview.pdf",
            fullUrl: "pdfs/11/maths/limits-full.pdf"
          }
        ],
        biology: [
          { name: "Cell Structure and Function",
            desc: "Ultrastructure of cell organelles, membrane models, transport mechanisms and quick diagrams frequently targeted in direct concept questions...",
            previewUrl: "pdfs/11/bio/cell-preview.pdf",
            fullUrl: "pdfs/11/bio/cell-full.pdf"
          },
          { name: "Biomolecules",
            desc: "Carbohydrates, proteins, lipids, nucleic acids, basic composition and tests that often appear in simple recall or match-the-column items...",
            previewUrl: "pdfs/11/bio/biomolecules-preview.pdf",
            fullUrl: "pdfs/11/bio/biomolecules-full.pdf"
          },
          { name: "Plant Physiology Basics",
            desc: "Water transport, photosynthesis overview, respiration and growth regulators compressed into quick revision lines for conceptual MCQs...",
            previewUrl: "pdfs/11/bio/plant-physiology-preview.pdf",
            fullUrl: "pdfs/11/bio/plant-physiology-full.pdf"
          }
        ]
      },
      "12": {
        physics: [
          { name: "Electrostatics",
            desc: "Charge distributions, Coulomb‚Äôs law, field and potential, capacitors and basic conductor problems forming the foundation of DC circuits...",
            previewUrl: "pdfs/12/physics/electrostatics-preview.pdf",
            fullUrl: "pdfs/12/physics/electrostatics-full.pdf"
          },
          { name: "Current Electricity",
            desc: "Ohm‚Äôs law, network reduction, Wheatstone and meter bridge, internal resistance and power dissipation questions repeated across past papers...",
            previewUrl: "pdfs/12/physics/current-electricity-preview.pdf",
            fullUrl: "pdfs/12/physics/current-electricity-full.pdf"
          },
          { name: "Magnetism and EMI",
            desc: "Biot‚ÄìSavart, Ampere‚Äôs law, force on conductors, Faraday induction, LCR basics and transformer ideas forming multi-concept JEE numericals...",
            previewUrl: "pdfs/12/physics/magnetism-preview.pdf",
            fullUrl: "pdfs/12/physics/magnetism-full.pdf"
          },
          { name: "Optics",
            desc: "Mirror-lens sign conventions, image formation, lens combinational setups plus interference and diffraction patterns from core wave optics models...",
            previewUrl: "pdfs/12/physics/optics-preview.pdf",
            fullUrl: "pdfs/12/physics/optics-full.pdf"
          },
          { name: "Modern Physics",
            desc: "Photoelectric effect, matter waves, Bohr model, nuclear reactions and decay law questions that often appear with straightforward calculations...",
            previewUrl: "pdfs/12/physics/modern-preview.pdf",
            fullUrl: "pdfs/12/physics/modern-full.pdf"
          }
        ],
        chemistry: [
          { name: "Solid State",
            desc: "Crystal lattices, unit cell types, packing efficiency, point defects and basic numericals connecting density with unit cell parameters...",
            previewUrl: "pdfs/12/chem/solid-state-preview.pdf",
            fullUrl: "pdfs/12/chem/solid-state-full.pdf"
          },
          { name: "Solutions",
            desc: "Concentration terms, Raoult‚Äôs law, ideal or non-ideal behaviour and colligative property questions built around boiling point or freezing data...",
            previewUrl: "pdfs/12/chem/solutions-preview.pdf",
            fullUrl: "pdfs/12/chem/solutions-full.pdf"
          },
          { name: "Electrochemistry",
            desc: "Nernst equation, galvanic and electrolytic cells, EMF, Faraday laws and simple battery or corrosion numericals favoured in JEE exams...",
            previewUrl: "pdfs/12/chem/electrochem-preview.pdf",
            fullUrl: "pdfs/12/chem/electrochem-full.pdf"
          },
          { name: "Chemical Kinetics",
            desc: "Rate laws, order, half-life, integrated equations and Arrhenius plots emphasising straight-line graph interpretation and quick parameter extraction...",
            previewUrl: "pdfs/12/chem/kinetics-preview.pdf",
            fullUrl: "pdfs/12/chem/kinetics-full.pdf"
          },
          { name: "p-Block and d-Block",
            desc: "Trends, oxides, halides, colour, magnetic behavior and frequently asked conceptual patterns across nitrogen, oxygen and transition series...",
            previewUrl: "pdfs/12/chem/pd-block-preview.pdf",
            fullUrl: "pdfs/12/chem/pd-block-full.pdf"
          }
        ],
        maths: [
          { name: "Matrices and Determinants",
            desc: "Inverse, adjoint, system-of-equation solutions and rank-based reasoning that converts word problems into compact matrix manipulations...",
            previewUrl: "pdfs/12/maths/matrices-preview.pdf",
            fullUrl: "pdfs/12/maths/matrices-full.pdf"
          },
          { name: "Continuity and Differentiability",
            desc: "Piecewise continuity checks, left-right derivatives, LMVT, Rolle‚Äôs theorem and common corner-point derivative traps used in problems...",
            previewUrl: "pdfs/12/maths/continuity-preview.pdf",
            fullUrl: "pdfs/12/maths/continuity-full.pdf"
          },
          { name: "Applications of Integrals",
            desc: "Area under curves, bounded regions and symmetry tricks that simplify repeated integration questions over standard polynomial or trigonometric graphs...",
            previewUrl: "pdfs/12/maths/app-integrals-preview.pdf",
            fullUrl: "pdfs/12/maths/app-integrals-full.pdf"
          },
          { name: "Vector Algebra and 3D",
            desc: "Dot and cross product, line-plane equations, shortest distance and angle-based questions that tightly connect algebra with spatial visualisation...",
            previewUrl: "pdfs/12/maths/vector-3d-preview.pdf",
            fullUrl: "pdfs/12/maths/vector-3d-full.pdf"
          },
          { name: "Probability",
            desc: "Conditional probability, Bayes theorem, random variable basics and compact JEE-style arrangements mixing combinatorics with probability ideas...",
            previewUrl: "pdfs/12/maths/probability-preview.pdf",
            fullUrl: "pdfs/12/maths/probability-full.pdf"
          }
        ],
        biology: [
          { name: "Human Physiology",
            desc: "Digestive, respiratory, circulatory and neural highlights arranged to answer direct one-liners and flow-based concept questions quickly...",
            previewUrl: "pdfs/12/bio/human-physiology-preview.pdf",
            fullUrl: "pdfs/12/bio/human-physiology-full.pdf"
          },
          { name: "Reproduction",
            desc: "Reproductive structures, gametogenesis, fertilisation and contraception points appearing in simple diagram- or fact-based questions...",
            previewUrl: "pdfs/12/bio/reproduction-preview.pdf",
            fullUrl: "pdfs/12/bio/reproduction-full.pdf"
          },
          { name: "Genetics and Evolution",
            desc: "Mendelian crosses, linkage, pedigrees and core evolutionary principles distilled into fast revision notes for frequently repeated MCQs...",
            previewUrl: "pdfs/12/bio/genetics-preview.pdf",
            fullUrl: "pdfs/12/bio/genetics-full.pdf"
          }
        ]
      }
    };

    let currentStep = 1;
    let selectedClass = null;
    let selectedSubjects = new Set();
    let isTransitioning = false;
    let currentPreviewFullUrl = null;

    function navigate(url) {
      document.body.classList.add('fade-out');
      setTimeout(() => { window.location.href = url; }, 350);
    }

    function setStep(step) {
      if (isTransitioning || step === currentStep) return;
      isTransitioning = true;

      const steps = document.querySelectorAll('.step');
      const oldStepEl = steps[currentStep - 1];
      const newStepEl = steps[step - 1];

      oldStepEl.classList.remove('active');
      newStepEl.classList.add('active');

      currentStep = step;
      setTimeout(() => { isTransitioning = false; }, 380);
    }

    function goToStep(step) {
      if (step === 2 && !selectedClass) return;
      if (step === 3 && selectedSubjects.size === 0) return;

      if (step === 2) {
        document.getElementById('classLabel').textContent = selectedClass;
      }
      if (step === 3) {
        document.getElementById('classLabel2').textContent = selectedClass;
        updateFiltersBadge();
        renderTopics('');
        document.getElementById('searchInput').value = '';
      }
      setStep(step);
    }

    function goBackStep() {
      if (currentStep === 1) navigate('index.html');
      else goToStep(currentStep - 1);
    }

    function restartAll() {
      selectedClass = null;
      selectedSubjects.clear();
      document.querySelectorAll('.pill-btn[data-class]').forEach(b => b.classList.remove('selected'));
      document.querySelectorAll('.subject-card').forEach(c => c.classList.remove('selected'));
      document.getElementById('toStep2Btn').disabled = true;
      document.getElementById('toStep3Btn').disabled = true;
      setStep(1);
    }

    function selectClass(btn) {
      selectedClass = btn.getAttribute('data-class');
      document.querySelectorAll('.pill-btn[data-class]').forEach(b => {
        b.classList.toggle('selected', b === btn);
      });
      document.getElementById('toStep2Btn').disabled = false;
    }

    function toggleSubject(card) {
      const key = card.getAttribute('data-subject');
      if (selectedSubjects.has(key)) {
        selectedSubjects.delete(key);
        card.classList.remove('selected');
      } else {
        selectedSubjects.add(key);
        card.classList.add('selected');
      }
      document.getElementById('toStep3Btn').disabled = selectedSubjects.size === 0;
    }

    function updateFiltersBadge() {
      const label = document.getElementById('activeFilters');
      if (selectedSubjects.size === 0) {
        label.textContent = 'No subject selected';
      } else {
        label.textContent = `Class ${selectedClass} ¬∑ ${Array.from(selectedSubjects).map(s => s.toUpperCase()).join(', ')}`;
      }
    }

    function renderTopics(query) {
      const container = document.getElementById('results');
      container.innerHTML = '';
      if (!selectedClass) return;

      const classData = topicsByClass[selectedClass];
      const q = (query || '').toLowerCase().trim();
      let list = [];

      selectedSubjects.forEach(sub => {
        const arr = classData[sub] || [];
        arr.forEach(t => list.push({ ...t, subject: sub }));
      });

      if (q) {
        list = list.filter(t =>
          t.name.toLowerCase().includes(q) ||
          t.desc.toLowerCase().includes(q)
        );
      }

      if (list.length === 0) {
        container.innerHTML = `<div class="empty-state">No topics match this search. Try another keyword or edit subject selection.</div>`;
        return;
      }

      list.forEach(t => {
        const color = getSubjectColor(t.subject);
        const card = document.createElement('div');
        card.className = 'topic-card';
        card.style.borderLeftColor = color;
        card.innerHTML = `
          <div class="topic-title-row">
            <div>
              <div class="topic-name">${t.name}</div>
              <div class="topic-meta">${t.subject.toUpperCase()} ¬∑ CLASS ${selectedClass}</div>
            </div>
          </div>
          <div class="topic-desc">${t.desc}</div>
        `;
        card.onclick = () => openPreview(t);
        container.appendChild(card);
      });
    }

    function getSubjectColor(sub) {
      if (sub === 'physics') return '#38bdf8';
      if (sub === 'chemistry') return '#14b8a6';
      if (sub === 'maths') return '#f97373';
      if (sub === 'biology') return '#22c55e';
      return '#e5e7eb';
    }

    // Preview modal logic
    function openPreview(topic) {
      const overlay = document.getElementById('previewOverlay');
      const frame   = document.getElementById('previewFrame');
      const titleEl = document.getElementById('previewTitle');
      const subEl   = document.getElementById('previewSubtitle');
      const fullBtn = document.getElementById('previewFullBtn');

      titleEl.textContent = topic.name;
      subEl.textContent   = `${topic.subject.toUpperCase()} ¬∑ CLASS ${selectedClass}`;
      currentPreviewFullUrl = topic.fullUrl || null;

      frame.src = topic.previewUrl;

      if (currentPreviewFullUrl) {
        fullBtn.disabled = false;
        fullBtn.onclick = () => {
          closePreview();
          smoothNavigateToFull(currentPreviewFullUrl);
        };
      } else {
        fullBtn.disabled = true;
        fullBtn.onclick = null;
      }

      overlay.style.display = 'flex';
    }

    function closePreview() {
      const overlay = document.getElementById('previewOverlay');
      const frame   = document.getElementById('previewFrame');
      overlay.style.display = 'none';
      frame.src = '';
    }

    function smoothNavigateToFull(url) {
      document.body.classList.add('fade-out');
      setTimeout(() => {
        window.location.href = url;
      }, 350);
    }

    document.addEventListener('click', (e) => {
      const overlay = document.getElementById('previewOverlay');
      if (!overlay || overlay.style.display === 'none') return;
      if (e.target.id === 'previewBackdrop') {
        closePreview();
      }
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closePreview();
    });

    document.addEventListener('DOMContentLoaded', () => {
      document.body.classList.add('loaded');
      const input = document.getElementById('searchInput');
      input.addEventListener('input', e => renderTopics(e.target.value));
    });
  </script>
</body>
</html>
